public class Contact_DAO {
	public static List<Contact> getContactsByEmail(String email) {
		List<Contact> contacts = [
			SELECT
				AccountId,
				Board_view_switched_space__c,
				Board_view_switched_user__c,
				Business_goal_column_value_set_space__c,
				Business_goal_column_value_set_user__c,
				cbit__ClearbitReady__c,
				cbit__Clearbit__c,
				cbit__CreatedByClearbit__c,
				cbit__Facebook__c,
				cbit__LinkedIn__c,
				cbit__Twitter__c,
				City__c,
				Column_filter_used_space__c,
				Column_filter_used_user__c,
				Complexity_column_value_set_space__c,
				Complexity_column_value_set_user__c,
				Contact_Source__c,
				Contact_Status__c,
				Contributors_invited_space__c,
				Contributors_invited_user__c,
				Country_Code__c,
				Country__c,
				CreatedById,
				CreatedDate,
				Department,
				Driver_created_space__c,
				Driver_created_user__c,
				Editors_invited_space__c,
				Editors_invited_user__c,
				Email,
				EmailBouncedDate,
				EmailBouncedReason,
				Family_Name__c,
				Fax,
				Features_board_shown_space__c,
				Features_board_shown_user__c,
				Feature_created_space__c,
				Feature_created_user__c,
				FirstName,
				Gender__c,
				Given_Name__c,
				HasOptedOutOfEmail,
				hasSubscription__c,
				Id,
				Indexed_At__c,
				Initiative_column_value_set_space__c,
				Initiative_column_value_set_user__c,
				isAdmin__c,
				isChurned__c,
				isContributor__c,
				IsDeleted,
				isEditor__c,
				IsEmailBounced,
				Paying_Customer_A__c,
				Paying_Customer_A_Last_Update__c,
				isTrial__c,
				isViewer__c,
				Jigsaw,
				JigsawContactId,
				Jira_import_issues_imported_space__c,
				Jira_import_issues_imported_user__c,
				LastActivityDate,
				LastCURequestDate,
				LastCUUpdateDate,
				LastModifiedById,
				LastModifiedDate,
				LastName,
				LastReferencedDate,
				LastViewedDate,
				LeadSource,
				Legacy_Lead_Source_March_2019__c,
				Lifecycle_Stage__c,
				LinkedIn__c,
				Location__c,
				MailingAddress,
				MailingCity,
				MailingCountry,
				MailingGeocodeAccuracy,
				MailingLatitude,
				MailingLongitude,
				MailingPostalCode,
				MailingState,
				MailingStreet,
				MasterRecordId,
				MiddleName,
				MobilePhone,
				Name,
				Notes_created_space__c,
				Notes_created_user__c,
				OwnerId,
				Person_External_ID__c,
				Phone,
				PhotoUrl,
				Portal_card_added_space__c,
				Portal_card_added_user__c,
				Portal_publishing_settings_changed_space__c,
				Portal_publishing_settings_changed_user__c,
				Portal_section_created_space__c,
				Portal_section_created_user__c,
				Portal_tab_created_space__c,
				Portal_tab_created_user__c,
				Project_Role__c,
				Public_idea_suggested_space__c,
				Public_idea_suggested_user__c,
				Public_insight_suggested_space__c,
				Public_insight_suggested_user__c,
				Release_created_space__c,
				Release_created_user__c,
				Removed_From_Project_Date__c,
				ReportsToId,
				Roadmap_printed_space__c,
				Roadmap_printed_user__c,
				Roadmap_release_toggled_space__c,
				Roadmap_release_toggled_user__c,
				Roadmap_shown_space__c,
				Roadmap_shown_user__c,
				Roadmap_view_switched_space__c,
				Roadmap_view_switched_user__c,
				Roadmap_visibility_toggled_space__c,
				Roadmap_visibility_toggled_user__c,
				Role__c,
				Salutation,
				Seniority__c,
				Signed_in_space__c,
				Signed_in_user__c,
				Site__c,
				Snippet_created_space__c,
				Snippet_created_user__c,
				State_Code__c,
				State__c,
				Suffix,
				SystemModstamp,
				Time_Zone__c,
				Title,
				Trial_End_Date__c,
				Trial_Request_DT__c,
				Trial_Source__c,
				Trial_Usage_Score__c,
				User_PB_ID__c,
				UTC_Offset__c,
				Viewers_invited_space__c,
				Viewers_invited_user__c,
				View_customized_space__c,
				View_customized_user__c,
				Productboard_Opt_in__c
			FROM Contact
			WHERE Email = :email
		];
		return contacts;
	}

	public static Contact getContactByEmail2(String email) {
		List<Contact> contacts = [
			SELECT
				AccountId,
				Board_view_switched_space__c,
				Board_view_switched_user__c,
				Business_goal_column_value_set_space__c,
				Business_goal_column_value_set_user__c,
				cbit__ClearbitReady__c,
				cbit__Clearbit__c,
				cbit__CreatedByClearbit__c,
				cbit__Facebook__c,
				cbit__LinkedIn__c,
				cbit__Twitter__c,
				City__c,
				Column_filter_used_space__c,
				Column_filter_used_user__c,
				Complexity_column_value_set_space__c,
				Complexity_column_value_set_user__c,
				Contact_Source__c,
				Contact_Status__c,
				Contributors_invited_space__c,
				Contributors_invited_user__c,
				Country_Code__c,
				Country__c,
				CreatedById,
				CreatedDate,
				Department,
				Driver_created_space__c,
				Driver_created_user__c,
				Editors_invited_space__c,
				Editors_invited_user__c,
				Email,
				EmailBouncedDate,
				EmailBouncedReason,
				Family_Name__c,
				Fax,
				Features_board_shown_space__c,
				Features_board_shown_user__c,
				Feature_created_space__c,
				Feature_created_user__c,
				FirstName,
				Gender__c,
				Given_Name__c,
				HasOptedOutOfEmail,
				hasSubscription__c,
				Id,
				Indexed_At__c,
				Initiative_column_value_set_space__c,
				Initiative_column_value_set_user__c,
				isAdmin__c,
				isChurned__c,
				isContributor__c,
				IsDeleted,
				isEditor__c,
				IsEmailBounced,
				Paying_Customer_A__c,
				Paying_Customer_A_Last_Update__c,
				isTrial__c,
				isViewer__c,
				Jigsaw,
				JigsawContactId,
				Jira_import_issues_imported_space__c,
				Jira_import_issues_imported_user__c,
				LastActivityDate,
				LastCURequestDate,
				LastCUUpdateDate,
				LastModifiedById,
				LastModifiedDate,
				LastName,
				LastReferencedDate,
				LastViewedDate,
				LeadSource,
				Legacy_Lead_Source_March_2019__c,
				Lifecycle_Stage__c,
				LinkedIn__c,
				Location__c,
				MailingAddress,
				MailingCity,
				MailingCountry,
				MailingGeocodeAccuracy,
				MailingLatitude,
				MailingLongitude,
				MailingPostalCode,
				MailingState,
				MailingStreet,
				MasterRecordId,
				MiddleName,
				MobilePhone,
				Name,
				Notes_created_space__c,
				Notes_created_user__c,
				OwnerId,
				Person_External_ID__c,
				Phone,
				PhotoUrl,
				Portal_card_added_space__c,
				Portal_card_added_user__c,
				Portal_publishing_settings_changed_space__c,
				Portal_publishing_settings_changed_user__c,
				Portal_section_created_space__c,
				Portal_section_created_user__c,
				Portal_tab_created_space__c,
				Portal_tab_created_user__c,
				Project_Role__c,
				Public_idea_suggested_space__c,
				Public_idea_suggested_user__c,
				Public_insight_suggested_space__c,
				Public_insight_suggested_user__c,
				Release_created_space__c,
				Release_created_user__c,
				Removed_From_Project_Date__c,
				ReportsToId,
				Roadmap_printed_space__c,
				Roadmap_printed_user__c,
				Roadmap_release_toggled_space__c,
				Roadmap_release_toggled_user__c,
				Roadmap_shown_space__c,
				Roadmap_shown_user__c,
				Roadmap_view_switched_space__c,
				Roadmap_view_switched_user__c,
				Roadmap_visibility_toggled_space__c,
				Roadmap_visibility_toggled_user__c,
				Role__c,
				Salutation,
				Seniority__c,
				Signed_in_space__c,
				Signed_in_user__c,
				Site__c,
				Snippet_created_space__c,
				Snippet_created_user__c,
				State_Code__c,
				State__c,
				Suffix,
				SystemModstamp,
				Time_Zone__c,
				Title,
				Trial_End_Date__c,
				Trial_Request_DT__c,
				Trial_Source__c,
				Trial_Usage_Score__c,
				User_PB_ID__c,
				UTC_Offset__c,
				Viewers_invited_space__c,
				Viewers_invited_user__c,
				View_customized_space__c,
				View_customized_user__c,
				Productboard_Opt_in__c
			FROM Contact
			WHERE Email = :email
		];
		if (contacts.isEmpty()) {
			throw new ProductboardException('Contact with email [' + email + '] was not found.', ApiConstants.CODE_FAILED_RECORD_NOT_FOUND);
		}
		if (contacts.size() > 1) {
			throw new ProductboardException(
				'More contacts with email [' +
				email +
				'] were found.',
				ApiConstants.CODE_FAILED_MORE_RECORDS_FOUND
			);
		}
		return contacts.get(0);
	}

	public static Contact getContactByPbUserId(Double userid) {
		List<Contact> contacts = [
			SELECT
				AccountId,
				Board_view_switched_space__c,
				Board_view_switched_user__c,
				Business_goal_column_value_set_space__c,
				Business_goal_column_value_set_user__c,
				cbit__ClearbitReady__c,
				cbit__Clearbit__c,
				cbit__CreatedByClearbit__c,
				cbit__Facebook__c,
				cbit__LinkedIn__c,
				cbit__Twitter__c,
				City__c,
				Column_filter_used_space__c,
				Column_filter_used_user__c,
				Complexity_column_value_set_space__c,
				Complexity_column_value_set_user__c,
				Contact_Source__c,
				Contact_Status__c,
				Contributors_invited_space__c,
				Contributors_invited_user__c,
				Country_Code__c,
				Country__c,
				CreatedById,
				CreatedDate,
				Department,
				Driver_created_space__c,
				Driver_created_user__c,
				Editors_invited_space__c,
				Editors_invited_user__c,
				Email,
				EmailBouncedDate,
				EmailBouncedReason,
				Family_Name__c,
				Fax,
				Features_board_shown_space__c,
				Features_board_shown_user__c,
				Feature_created_space__c,
				Feature_created_user__c,
				FirstName,
				Gender__c,
				Given_Name__c,
				HasOptedOutOfEmail,
				hasSubscription__c,
				Id,
				Indexed_At__c,
				Initiative_column_value_set_space__c,
				Initiative_column_value_set_user__c,
				isAdmin__c,
				isChurned__c,
				isContributor__c,
				IsDeleted,
				isEditor__c,
				IsEmailBounced,
				Paying_Customer_A__c,
				Paying_Customer_A_Last_Update__c,
				isTrial__c,
				isViewer__c,
				Jigsaw,
				JigsawContactId,
				Jira_import_issues_imported_space__c,
				Jira_import_issues_imported_user__c,
				LastActivityDate,
				LastCURequestDate,
				LastCUUpdateDate,
				LastModifiedById,
				LastModifiedDate,
				LastName,
				LastReferencedDate,
				LastViewedDate,
				LeadSource,
				Legacy_Lead_Source_March_2019__c,
				Lifecycle_Stage__c,
				LinkedIn__c,
				Location__c,
				MailingAddress,
				MailingCity,
				MailingCountry,
				MailingGeocodeAccuracy,
				MailingLatitude,
				MailingLongitude,
				MailingPostalCode,
				MailingState,
				MailingStreet,
				MasterRecordId,
				MiddleName,
				MobilePhone,
				Name,
				Notes_created_space__c,
				Notes_created_user__c,
				OwnerId,
				Person_External_ID__c,
				Phone,
				PhotoUrl,
				Portal_card_added_space__c,
				Portal_card_added_user__c,
				Portal_publishing_settings_changed_space__c,
				Portal_publishing_settings_changed_user__c,
				Portal_section_created_space__c,
				Portal_section_created_user__c,
				Portal_tab_created_space__c,
				Portal_tab_created_user__c,
				Project_Role__c,
				Public_idea_suggested_space__c,
				Public_idea_suggested_user__c,
				Public_insight_suggested_space__c,
				Public_insight_suggested_user__c,
				Release_created_space__c,
				Release_created_user__c,
				Removed_From_Project_Date__c,
				ReportsToId,
				Roadmap_printed_space__c,
				Roadmap_printed_user__c,
				Roadmap_release_toggled_space__c,
				Roadmap_release_toggled_user__c,
				Roadmap_shown_space__c,
				Roadmap_shown_user__c,
				Roadmap_view_switched_space__c,
				Roadmap_view_switched_user__c,
				Roadmap_visibility_toggled_space__c,
				Roadmap_visibility_toggled_user__c,
				Role__c,
				Salutation,
				Seniority__c,
				Signed_in_space__c,
				Signed_in_user__c,
				Site__c,
				Snippet_created_space__c,
				Snippet_created_user__c,
				State_Code__c,
				State__c,
				Suffix,
				SystemModstamp,
				Time_Zone__c,
				Title,
				Trial_End_Date__c,
				Trial_Request_DT__c,
				Trial_Source__c,
				Trial_Usage_Score__c,
				User_PB_ID__c,
				UTC_Offset__c,
				Viewers_invited_space__c,
				Viewers_invited_user__c,
				View_customized_space__c,
				View_customized_user__c,
				Productboard_Opt_in__c
			FROM Contact
			WHERE User_PB_ID__c = :userid
		];
		if (contacts.isEmpty()) {
			throw new ProductboardException(
				'Contact with user pb id [' +
				userid +
				'] was not found.',
				ApiConstants.CODE_FAILED_RECORD_NOT_FOUND
			);
		}
		if (contacts.size() > 1) {
			throw new ProductboardException(
				'More contacts with user pb id [' +
				userid +
				'] were found.',
				ApiConstants.CODE_FAILED_MORE_RECORDS_FOUND
			);
		}
		return contacts.get(0);
	}

	public static List<Contact> getContactbyId(Id id) {
		List<Contact> contacts = [
			SELECT
				AccountId,
				Board_view_switched_space__c,
				Board_view_switched_user__c,
				Business_goal_column_value_set_space__c,
				Business_goal_column_value_set_user__c,
				cbit__ClearbitReady__c,
				cbit__Clearbit__c,
				cbit__CreatedByClearbit__c,
				cbit__Facebook__c,
				cbit__LinkedIn__c,
				cbit__Twitter__c,
				City__c,
				Column_filter_used_space__c,
				Column_filter_used_user__c,
				Complexity_column_value_set_space__c,
				Complexity_column_value_set_user__c,
				Contact_Source__c,
				Contact_Status__c,
				Contributors_invited_space__c,
				Contributors_invited_user__c,
				Country_Code__c,
				Country__c,
				CreatedById,
				CreatedDate,
				Department,
				Driver_created_space__c,
				Driver_created_user__c,
				Editors_invited_space__c,
				Editors_invited_user__c,
				Email,
				EmailBouncedDate,
				EmailBouncedReason,
				Family_Name__c,
				Fax,
				Features_board_shown_space__c,
				Features_board_shown_user__c,
				Feature_created_space__c,
				Feature_created_user__c,
				FirstName,
				Gender__c,
				Given_Name__c,
				HasOptedOutOfEmail,
				hasSubscription__c,
				Id,
				Indexed_At__c,
				Initiative_column_value_set_space__c,
				Initiative_column_value_set_user__c,
				isAdmin__c,
				isChurned__c,
				isContributor__c,
				IsDeleted,
				isEditor__c,
				IsEmailBounced,
				Paying_Customer_A__c,
				Paying_Customer_A_Last_Update__c,
				isTrial__c,
				isViewer__c,
				Jigsaw,
				JigsawContactId,
				Jira_import_issues_imported_space__c,
				Jira_import_issues_imported_user__c,
				LastActivityDate,
				LastCURequestDate,
				LastCUUpdateDate,
				LastModifiedById,
				LastModifiedDate,
				LastName,
				LastReferencedDate,
				LastViewedDate,
				LeadSource,
				Legacy_Lead_Source_March_2019__c,
				Lifecycle_Stage__c,
				LinkedIn__c,
				Location__c,
				MailingAddress,
				MailingCity,
				MailingCountry,
				MailingGeocodeAccuracy,
				MailingLatitude,
				MailingLongitude,
				MailingPostalCode,
				MailingState,
				MailingStreet,
				MasterRecordId,
				MiddleName,
				MobilePhone,
				Name,
				Notes_created_space__c,
				Notes_created_user__c,
				OwnerId,
				Person_External_ID__c,
				Phone,
				PhotoUrl,
				Portal_card_added_space__c,
				Portal_card_added_user__c,
				Portal_publishing_settings_changed_space__c,
				Portal_publishing_settings_changed_user__c,
				Portal_section_created_space__c,
				Portal_section_created_user__c,
				Portal_tab_created_space__c,
				Portal_tab_created_user__c,
				Project_Role__c,
				Public_idea_suggested_space__c,
				Public_idea_suggested_user__c,
				Public_insight_suggested_space__c,
				Public_insight_suggested_user__c,
				Release_created_space__c,
				Release_created_user__c,
				Removed_From_Project_Date__c,
				ReportsToId,
				Roadmap_printed_space__c,
				Roadmap_printed_user__c,
				Roadmap_release_toggled_space__c,
				Roadmap_release_toggled_user__c,
				Roadmap_shown_space__c,
				Roadmap_shown_user__c,
				Roadmap_view_switched_space__c,
				Roadmap_view_switched_user__c,
				Roadmap_visibility_toggled_space__c,
				Roadmap_visibility_toggled_user__c,
				Role__c,
				Salutation,
				Seniority__c,
				Signed_in_space__c,
				Signed_in_user__c,
				Site__c,
				Snippet_created_space__c,
				Snippet_created_user__c,
				State_Code__c,
				State__c,
				Suffix,
				SystemModstamp,
				Time_Zone__c,
				Title,
				Trial_End_Date__c,
				Trial_Request_DT__c,
				Trial_Source__c,
				Trial_Usage_Score__c,
				User_PB_ID__c,
				UTC_Offset__c,
				Viewers_invited_space__c,
				Viewers_invited_user__c,
				View_customized_space__c,
				View_customized_user__c,
				Productboard_Opt_in__c
			FROM Contact
			WHERE Id = :id
		];
		return contacts;
	}

	public static List<Contact> getContactbyId2(Id id) {
		List<Contact> contacts = [
			SELECT
				AccountId,
				Board_view_switched_space__c,
				Board_view_switched_user__c,
				Business_goal_column_value_set_space__c,
				Business_goal_column_value_set_user__c,
				cbit__ClearbitReady__c,
				cbit__Clearbit__c,
				cbit__CreatedByClearbit__c,
				cbit__Facebook__c,
				cbit__LinkedIn__c,
				cbit__Twitter__c,
				City__c,
				Column_filter_used_space__c,
				Column_filter_used_user__c,
				Complexity_column_value_set_space__c,
				Complexity_column_value_set_user__c,
				Contact_Source__c,
				Contact_Status__c,
				Contributors_invited_space__c,
				Contributors_invited_user__c,
				Country_Code__c,
				Country__c,
				CreatedById,
				CreatedDate,
				Department,
				Driver_created_space__c,
				Driver_created_user__c,
				Editors_invited_space__c,
				Editors_invited_user__c,
				Email,
				EmailBouncedDate,
				EmailBouncedReason,
				Family_Name__c,
				Fax,
				Features_board_shown_space__c,
				Features_board_shown_user__c,
				Feature_created_space__c,
				Feature_created_user__c,
				FirstName,
				Gender__c,
				Given_Name__c,
				HasOptedOutOfEmail,
				hasSubscription__c,
				Id,
				Indexed_At__c,
				Initiative_column_value_set_space__c,
				Initiative_column_value_set_user__c,
				isAdmin__c,
				isChurned__c,
				isContributor__c,
				IsDeleted,
				isEditor__c,
				IsEmailBounced,
				Paying_Customer_A__c,
				Paying_Customer_A_Last_Update__c,
				isTrial__c,
				isViewer__c,
				Jigsaw,
				JigsawContactId,
				Jira_import_issues_imported_space__c,
				Jira_import_issues_imported_user__c,
				LastActivityDate,
				LastCURequestDate,
				LastCUUpdateDate,
				LastModifiedById,
				LastModifiedDate,
				LastName,
				LastReferencedDate,
				LastViewedDate,
				LeadSource,
				Legacy_Lead_Source_March_2019__c,
				Lifecycle_Stage__c,
				LinkedIn__c,
				Location__c,
				MailingAddress,
				MailingCity,
				MailingCountry,
				MailingGeocodeAccuracy,
				MailingLatitude,
				MailingLongitude,
				MailingPostalCode,
				MailingState,
				MailingStreet,
				MasterRecordId,
				MiddleName,
				MobilePhone,
				Name,
				Notes_created_space__c,
				Notes_created_user__c,
				OwnerId,
				Person_External_ID__c,
				Phone,
				PhotoUrl,
				Portal_card_added_space__c,
				Portal_card_added_user__c,
				Portal_publishing_settings_changed_space__c,
				Portal_publishing_settings_changed_user__c,
				Portal_section_created_space__c,
				Portal_section_created_user__c,
				Portal_tab_created_space__c,
				Portal_tab_created_user__c,
				Project_Role__c,
				Public_idea_suggested_space__c,
				Public_idea_suggested_user__c,
				Public_insight_suggested_space__c,
				Public_insight_suggested_user__c,
				Release_created_space__c,
				Release_created_user__c,
				Removed_From_Project_Date__c,
				ReportsToId,
				Roadmap_printed_space__c,
				Roadmap_printed_user__c,
				Roadmap_release_toggled_space__c,
				Roadmap_release_toggled_user__c,
				Roadmap_shown_space__c,
				Roadmap_shown_user__c,
				Roadmap_view_switched_space__c,
				Roadmap_view_switched_user__c,
				Roadmap_visibility_toggled_space__c,
				Roadmap_visibility_toggled_user__c,
				Role__c,
				Salutation,
				Seniority__c,
				Signed_in_space__c,
				Signed_in_user__c,
				Site__c,
				Snippet_created_space__c,
				Snippet_created_user__c,
				State_Code__c,
				State__c,
				Suffix,
				SystemModstamp,
				Time_Zone__c,
				Title,
				Trial_End_Date__c,
				Trial_Request_DT__c,
				Trial_Source__c,
				Trial_Usage_Score__c,
				User_PB_ID__c,
				UTC_Offset__c,
				Viewers_invited_space__c,
				Viewers_invited_user__c,
				View_customized_space__c,
				View_customized_user__c,
				Productboard_Opt_in__c
			FROM Contact
			WHERE Id = :id
		];
		if (contacts.isEmpty()) {
			throw new ProductboardException('Contact with ID [' + id + '] was not found.', ApiConstants.CODE_FAILED_RECORD_NOT_FOUND);
		}
		return contacts;
	}

	public static List<Contact> getContactbyListOfIds(List<Id> ids) {
		List<Contact> contacts = [
			SELECT
				AccountId,
				Board_view_switched_space__c,
				Board_view_switched_user__c,
				Business_goal_column_value_set_space__c,
				Business_goal_column_value_set_user__c,
				cbit__ClearbitReady__c,
				cbit__Clearbit__c,
				cbit__CreatedByClearbit__c,
				cbit__Facebook__c,
				cbit__LinkedIn__c,
				cbit__Twitter__c,
				City__c,
				Column_filter_used_space__c,
				Column_filter_used_user__c,
				Complexity_column_value_set_space__c,
				Complexity_column_value_set_user__c,
				Contact_Source__c,
				Contact_Status__c,
				Contributors_invited_space__c,
				Contributors_invited_user__c,
				Country_Code__c,
				Country__c,
				CreatedById,
				CreatedDate,
				Department,
				Driver_created_space__c,
				Driver_created_user__c,
				Editors_invited_space__c,
				Editors_invited_user__c,
				Email,
				EmailBouncedDate,
				EmailBouncedReason,
				Family_Name__c,
				Fax,
				Features_board_shown_space__c,
				Features_board_shown_user__c,
				Feature_created_space__c,
				Feature_created_user__c,
				FirstName,
				Gender__c,
				Given_Name__c,
				HasOptedOutOfEmail,
				hasSubscription__c,
				Id,
				Indexed_At__c,
				Initiative_column_value_set_space__c,
				Initiative_column_value_set_user__c,
				isAdmin__c,
				isChurned__c,
				isContributor__c,
				IsDeleted,
				isEditor__c,
				IsEmailBounced,
				Paying_Customer_A__c,
				Paying_Customer_A_Last_Update__c,
				isTrial__c,
				isViewer__c,
				Jigsaw,
				JigsawContactId,
				Jira_import_issues_imported_space__c,
				Jira_import_issues_imported_user__c,
				LastActivityDate,
				LastCURequestDate,
				LastCUUpdateDate,
				LastModifiedById,
				LastModifiedDate,
				LastName,
				LastReferencedDate,
				LastViewedDate,
				LeadSource,
				Legacy_Lead_Source_March_2019__c,
				Lifecycle_Stage__c,
				LinkedIn__c,
				Location__c,
				MailingAddress,
				MailingCity,
				MailingCountry,
				MailingGeocodeAccuracy,
				MailingLatitude,
				MailingLongitude,
				MailingPostalCode,
				MailingState,
				MailingStreet,
				MasterRecordId,
				MiddleName,
				MobilePhone,
				Name,
				Notes_created_space__c,
				Notes_created_user__c,
				OwnerId,
				Person_External_ID__c,
				Phone,
				PhotoUrl,
				Portal_card_added_space__c,
				Portal_card_added_user__c,
				Portal_publishing_settings_changed_space__c,
				Portal_publishing_settings_changed_user__c,
				Portal_section_created_space__c,
				Portal_section_created_user__c,
				Portal_tab_created_space__c,
				Portal_tab_created_user__c,
				Project_Role__c,
				Public_idea_suggested_space__c,
				Public_idea_suggested_user__c,
				Public_insight_suggested_space__c,
				Public_insight_suggested_user__c,
				Release_created_space__c,
				Release_created_user__c,
				Removed_From_Project_Date__c,
				ReportsToId,
				Roadmap_printed_space__c,
				Roadmap_printed_user__c,
				Roadmap_release_toggled_space__c,
				Roadmap_release_toggled_user__c,
				Roadmap_shown_space__c,
				Roadmap_shown_user__c,
				Roadmap_view_switched_space__c,
				Roadmap_view_switched_user__c,
				Roadmap_visibility_toggled_space__c,
				Roadmap_visibility_toggled_user__c,
				Role__c,
				Salutation,
				Seniority__c,
				Signed_in_space__c,
				Signed_in_user__c,
				Site__c,
				Snippet_created_space__c,
				Snippet_created_user__c,
				State_Code__c,
				State__c,
				Suffix,
				SystemModstamp,
				Time_Zone__c,
				Title,
				Trial_End_Date__c,
				Trial_Request_DT__c,
				Trial_Source__c,
				Trial_Usage_Score__c,
				User_PB_ID__c,
				UTC_Offset__c,
				Viewers_invited_space__c,
				Viewers_invited_user__c,
				View_customized_space__c,
				View_customized_user__c,
				Productboard_Opt_in__c
			FROM Contact
			WHERE Id = :ids
		];
		if (contacts.isEmpty()) {
			throw new ProductboardException('No contact were found for this ID set.', ApiConstants.CODE_FAILED_RECORD_NOT_FOUND);
		}
		return contacts;
	}

	public static List<Contact> getContactsByIds(List<Id> ids) {
		List<Contact> contacts = [
				SELECT
						AccountId,
						Board_view_switched_space__c,
						Board_view_switched_user__c,
						Business_goal_column_value_set_space__c,
						Business_goal_column_value_set_user__c,
						cbit__ClearbitReady__c,
						cbit__Clearbit__c,
						cbit__CreatedByClearbit__c,
						cbit__Facebook__c,
						cbit__LinkedIn__c,
						cbit__Twitter__c,
						City__c,
						Column_filter_used_space__c,
						Column_filter_used_user__c,
						Complexity_column_value_set_space__c,
						Complexity_column_value_set_user__c,
						Contact_Source__c,
						Contact_Status__c,
						Contributors_invited_space__c,
						Contributors_invited_user__c,
						Country_Code__c,
						Country__c,
						CreatedById,
						CreatedDate,
						Department,
						Driver_created_space__c,
						Driver_created_user__c,
						Editors_invited_space__c,
						Editors_invited_user__c,
						Email,
						EmailBouncedDate,
						EmailBouncedReason,
						Family_Name__c,
						Fax,
						Features_board_shown_space__c,
						Features_board_shown_user__c,
						Feature_created_space__c,
						Feature_created_user__c,
						FirstName,
						Gender__c,
						Given_Name__c,
						HasOptedOutOfEmail,
						hasSubscription__c,
						Id,
						Indexed_At__c,
						Initiative_column_value_set_space__c,
						Initiative_column_value_set_user__c,
						isAdmin__c,
						isChurned__c,
						isContributor__c,
						IsDeleted,
						isEditor__c,
						IsEmailBounced,
						Paying_Customer_A__c,
						Paying_Customer_A_Last_Update__c,
						isTrial__c,
						isViewer__c,
						Jigsaw,
						JigsawContactId,
						Jira_import_issues_imported_space__c,
						Jira_import_issues_imported_user__c,
						LastActivityDate,
						LastCURequestDate,
						LastCUUpdateDate,
						LastModifiedById,
						LastModifiedDate,
						LastName,
						LastReferencedDate,
						LastViewedDate,
						LeadSource,
						Legacy_Lead_Source_March_2019__c,
						Lifecycle_Stage__c,
						LinkedIn__c,
						Location__c,
						MailingAddress,
						MailingCity,
						MailingCountry,
						MailingGeocodeAccuracy,
						MailingLatitude,
						MailingLongitude,
						MailingPostalCode,
						MailingState,
						MailingStreet,
						MasterRecordId,
						MiddleName,
						MobilePhone,
						Name,
						Notes_created_space__c,
						Notes_created_user__c,
						OwnerId,
						Person_External_ID__c,
						Phone,
						PhotoUrl,
						Portal_card_added_space__c,
						Portal_card_added_user__c,
						Portal_publishing_settings_changed_space__c,
						Portal_publishing_settings_changed_user__c,
						Portal_section_created_space__c,
						Portal_section_created_user__c,
						Portal_tab_created_space__c,
						Portal_tab_created_user__c,
						Project_Role__c,
						Public_idea_suggested_space__c,
						Public_idea_suggested_user__c,
						Public_insight_suggested_space__c,
						Public_insight_suggested_user__c,
						Release_created_space__c,
						Release_created_user__c,
						Removed_From_Project_Date__c,
						ReportsToId,
						Roadmap_printed_space__c,
						Roadmap_printed_user__c,
						Roadmap_release_toggled_space__c,
						Roadmap_release_toggled_user__c,
						Roadmap_shown_space__c,
						Roadmap_shown_user__c,
						Roadmap_view_switched_space__c,
						Roadmap_view_switched_user__c,
						Roadmap_visibility_toggled_space__c,
						Roadmap_visibility_toggled_user__c,
						Role__c,
						Salutation,
						Seniority__c,
						Signed_in_space__c,
						Signed_in_user__c,
						Site__c,
						Snippet_created_space__c,
						Snippet_created_user__c,
						State_Code__c,
						State__c,
						Suffix,
						SystemModstamp,
						Time_Zone__c,
						Title,
						Trial_End_Date__c,
						Trial_Request_DT__c,
						Trial_Source__c,
						Trial_Usage_Score__c,
						User_PB_ID__c,
						UTC_Offset__c,
						Viewers_invited_space__c,
						Viewers_invited_user__c,
						View_customized_space__c,
						View_customized_user__c,
						Productboard_Opt_in__c
				FROM Contact
				WHERE Id = :ids
		];
		return contacts;
	}

	public static Contact getMasterContactByProjectNoExc(Project__c pr) {
		List<Contact> contacts = [
				SELECT
						AccountId,
						Board_view_switched_space__c,
						Board_view_switched_user__c,
						Business_goal_column_value_set_space__c,
						Business_goal_column_value_set_user__c,
						cbit__ClearbitReady__c,
						cbit__Clearbit__c,
						cbit__CreatedByClearbit__c,
						cbit__Facebook__c,
						cbit__LinkedIn__c,
						cbit__Twitter__c,
						City__c,
						Column_filter_used_space__c,
						Column_filter_used_user__c,
						Complexity_column_value_set_space__c,
						Complexity_column_value_set_user__c,
						Contact_Source__c,
						Contact_Status__c,
						Contributors_invited_space__c,
						Contributors_invited_user__c,
						Country_Code__c,
						Country__c,
						CreatedById,
						CreatedDate,
						Department,
						Driver_created_space__c,
						Driver_created_user__c,
						Editors_invited_space__c,
						Editors_invited_user__c,
						Email,
						EmailBouncedDate,
						EmailBouncedReason,
						Family_Name__c,
						Fax,
						Features_board_shown_space__c,
						Features_board_shown_user__c,
						Feature_created_space__c,
						Feature_created_user__c,
						FirstName,
						Gender__c,
						Given_Name__c,
						HasOptedOutOfEmail,
						hasSubscription__c,
						Id,
						Indexed_At__c,
						Initiative_column_value_set_space__c,
						Initiative_column_value_set_user__c,
						isAdmin__c,
						isChurned__c,
						isContributor__c,
						IsDeleted,
						isEditor__c,
						IsEmailBounced,
						Paying_Customer_A__c,
						Paying_Customer_A_Last_Update__c,
						isTrial__c,
						isViewer__c,
						Jigsaw,
						JigsawContactId,
						Jira_import_issues_imported_space__c,
						Jira_import_issues_imported_user__c,
						LastActivityDate,
						LastCURequestDate,
						LastCUUpdateDate,
						LastModifiedById,
						LastModifiedDate,
						LastName,
						LastReferencedDate,
						LastViewedDate,
						LeadSource,
						Legacy_Lead_Source_March_2019__c,
						Lifecycle_Stage__c,
						LinkedIn__c,
						Location__c,
						MailingAddress,
						MailingCity,
						MailingCountry,
						MailingGeocodeAccuracy,
						MailingLatitude,
						MailingLongitude,
						MailingPostalCode,
						MailingState,
						MailingStreet,
						MasterRecordId,
						MiddleName,
						MobilePhone,
						Name,
						Notes_created_space__c,
						Notes_created_user__c,
						OwnerId,
						Person_External_ID__c,
						Phone,
						PhotoUrl,
						Portal_card_added_space__c,
						Portal_card_added_user__c,
						Portal_publishing_settings_changed_space__c,
						Portal_publishing_settings_changed_user__c,
						Portal_section_created_space__c,
						Portal_section_created_user__c,
						Portal_tab_created_space__c,
						Portal_tab_created_user__c,
						Project_Role__c,
						Public_idea_suggested_space__c,
						Public_idea_suggested_user__c,
						Public_insight_suggested_space__c,
						Public_insight_suggested_user__c,
						Release_created_space__c,
						Release_created_user__c,
						Removed_From_Project_Date__c,
						ReportsToId,
						Roadmap_printed_space__c,
						Roadmap_printed_user__c,
						Roadmap_release_toggled_space__c,
						Roadmap_release_toggled_user__c,
						Roadmap_shown_space__c,
						Roadmap_shown_user__c,
						Roadmap_view_switched_space__c,
						Roadmap_view_switched_user__c,
						Roadmap_visibility_toggled_space__c,
						Roadmap_visibility_toggled_user__c,
						Role__c,
						Salutation,
						Seniority__c,
						Signed_in_space__c,
						Signed_in_user__c,
						Site__c,
						Snippet_created_space__c,
						Snippet_created_user__c,
						State_Code__c,
						State__c,
						Suffix,
						SystemModstamp,
						Time_Zone__c,
						Title,
						Trial_End_Date__c,
						Trial_Request_DT__c,
						Trial_Source__c,
						Trial_Usage_Score__c,
						User_PB_ID__c,
						UTC_Offset__c,
						Viewers_invited_space__c,
						Viewers_invited_user__c,
						View_customized_space__c,
						View_customized_user__c,
						Productboard_Opt_in__c
				FROM Contact
				WHERE Id = :pr.Master_User_Contact__c
		];
		if (contacts.isEmpty()) {
			return null;
		}
		return contacts.get(0);
	}

	public static Contact getMasterContactByProject(Project__c pr) {
		List<Contact> contacts = [
			SELECT
				AccountId,
				Board_view_switched_space__c,
				Board_view_switched_user__c,
				Business_goal_column_value_set_space__c,
				Business_goal_column_value_set_user__c,
				cbit__ClearbitReady__c,
				cbit__Clearbit__c,
				cbit__CreatedByClearbit__c,
				cbit__Facebook__c,
				cbit__LinkedIn__c,
				cbit__Twitter__c,
				City__c,
				Column_filter_used_space__c,
				Column_filter_used_user__c,
				Complexity_column_value_set_space__c,
				Complexity_column_value_set_user__c,
				Contact_Source__c,
				Contact_Status__c,
				Contributors_invited_space__c,
				Contributors_invited_user__c,
				Country_Code__c,
				Country__c,
				CreatedById,
				CreatedDate,
				Department,
				Driver_created_space__c,
				Driver_created_user__c,
				Editors_invited_space__c,
				Editors_invited_user__c,
				Email,
				EmailBouncedDate,
				EmailBouncedReason,
				Family_Name__c,
				Fax,
				Features_board_shown_space__c,
				Features_board_shown_user__c,
				Feature_created_space__c,
				Feature_created_user__c,
				FirstName,
				Gender__c,
				Given_Name__c,
				HasOptedOutOfEmail,
				hasSubscription__c,
				Id,
				Indexed_At__c,
				Initiative_column_value_set_space__c,
				Initiative_column_value_set_user__c,
				isAdmin__c,
				isChurned__c,
				isContributor__c,
				IsDeleted,
				isEditor__c,
				IsEmailBounced,
				Paying_Customer_A__c,
				Paying_Customer_A_Last_Update__c,
				isTrial__c,
				isViewer__c,
				Jigsaw,
				JigsawContactId,
				Jira_import_issues_imported_space__c,
				Jira_import_issues_imported_user__c,
				LastActivityDate,
				LastCURequestDate,
				LastCUUpdateDate,
				LastModifiedById,
				LastModifiedDate,
				LastName,
				LastReferencedDate,
				LastViewedDate,
				LeadSource,
				Legacy_Lead_Source_March_2019__c,
				Lifecycle_Stage__c,
				LinkedIn__c,
				Location__c,
				MailingAddress,
				MailingCity,
				MailingCountry,
				MailingGeocodeAccuracy,
				MailingLatitude,
				MailingLongitude,
				MailingPostalCode,
				MailingState,
				MailingStreet,
				MasterRecordId,
				MiddleName,
				MobilePhone,
				Name,
				Notes_created_space__c,
				Notes_created_user__c,
				OwnerId,
				Person_External_ID__c,
				Phone,
				PhotoUrl,
				Portal_card_added_space__c,
				Portal_card_added_user__c,
				Portal_publishing_settings_changed_space__c,
				Portal_publishing_settings_changed_user__c,
				Portal_section_created_space__c,
				Portal_section_created_user__c,
				Portal_tab_created_space__c,
				Portal_tab_created_user__c,
				Project_Role__c,
				Public_idea_suggested_space__c,
				Public_idea_suggested_user__c,
				Public_insight_suggested_space__c,
				Public_insight_suggested_user__c,
				Release_created_space__c,
				Release_created_user__c,
				Removed_From_Project_Date__c,
				ReportsToId,
				Roadmap_printed_space__c,
				Roadmap_printed_user__c,
				Roadmap_release_toggled_space__c,
				Roadmap_release_toggled_user__c,
				Roadmap_shown_space__c,
				Roadmap_shown_user__c,
				Roadmap_view_switched_space__c,
				Roadmap_view_switched_user__c,
				Roadmap_visibility_toggled_space__c,
				Roadmap_visibility_toggled_user__c,
				Role__c,
				Salutation,
				Seniority__c,
				Signed_in_space__c,
				Signed_in_user__c,
				Site__c,
				Snippet_created_space__c,
				Snippet_created_user__c,
				State_Code__c,
				State__c,
				Suffix,
				SystemModstamp,
				Time_Zone__c,
				Title,
				Trial_End_Date__c,
				Trial_Request_DT__c,
				Trial_Source__c,
				Trial_Usage_Score__c,
				User_PB_ID__c,
				UTC_Offset__c,
				Viewers_invited_space__c,
				Viewers_invited_user__c,
				View_customized_space__c,
				View_customized_user__c,
				Productboard_Opt_in__c
			FROM Contact
			WHERE Id = :pr.Master_User_Contact__c
		];
		if (contacts.isEmpty()) {
			throw new ProductboardException(
				'Contact with ID [' +
				pr.Master_User_Contact__c +
				'] was not found.',
				ApiConstants.CODE_FAILED_RECORD_NOT_FOUND
			);
		}
		return contacts.get(0);
	}

	public static List<Contact> getAllMasterContactsWithClearbitRecordSystemAcc(Id systemAccountId, Integer contactLimit) {
		List<Contact> contacts = [
			SELECT
				AccountId,
				Board_view_switched_space__c,
				Board_view_switched_user__c,
				Business_goal_column_value_set_space__c,
				Business_goal_column_value_set_user__c,
				cbit__ClearbitReady__c,
				cbit__Clearbit__c,
				cbit__CreatedByClearbit__c,
				cbit__Facebook__c,
				cbit__LinkedIn__c,
				cbit__Twitter__c,
				City__c,
				Column_filter_used_space__c,
				Column_filter_used_user__c,
				Complexity_column_value_set_space__c,
				Complexity_column_value_set_user__c,
				Contact_Source__c,
				Contact_Status__c,
				Contributors_invited_space__c,
				Contributors_invited_user__c,
				Country_Code__c,
				Country__c,
				CreatedById,
				CreatedDate,
				Department,
				Driver_created_space__c,
				Driver_created_user__c,
				Editors_invited_space__c,
				Editors_invited_user__c,
				Email,
				EmailBouncedDate,
				Feature_created_user__c,
				FirstName,
				Gender__c,
				Given_Name__c,
				HasOptedOutOfEmail,
				hasSubscription__c,
				Id,
				Indexed_At__c,
				Initiative_column_value_set_space__c,
				Initiative_column_value_set_user__c,
				isAdmin__c,
				isChurned__c,
				isContributor__c,
				IsDeleted,
				isEditor__c,
				IsEmailBounced,
				Paying_Customer_A__c,
				Paying_Customer_A_Last_Update__c,
				isTrial__c,
				isViewer__c,
				Jigsaw,
				JigsawContactId,
				Jira_import_issues_imported_space__c,
				Jira_import_issues_imported_user__c,
				LastActivityDate,
				LastCURequestDate,
				LastCUUpdateDate,
				Roadmap_shown_space__c,
				Roadmap_shown_user__c,
				Roadmap_view_switched_space__c,
				Roadmap_view_switched_user__c,
				Roadmap_visibility_toggled_space__c,
				Roadmap_visibility_toggled_user__c,
				Role__c,
				Salutation,
				Seniority__c,
				Signed_in_space__c,
				Signed_in_user__c,
				Site__c,
				Snippet_created_space__c,
				Snippet_created_user__c,
				State_Code__c,
				State__c,
				Suffix,
				SystemModstamp,
				Time_Zone__c,
				Title,
				Trial_End_Date__c,
				Trial_Request_DT__c,
				Trial_Source__c,
				Trial_Usage_Score__c,
				User_PB_ID__c,
				UTC_Offset__c,
				Viewers_invited_space__c,
				Viewers_invited_user__c,
				View_customized_space__c,
				View_customized_user__c,
				Productboard_Opt_in__c,
				SystemAccScriptUpdated__c
			FROM Contact
			WHERE
				cbit__Clearbit__c != NULL
				AND Trial_Source__c = 'Trial Owner'
				AND AccountId = :systemAccountId
				AND SystemAccScriptUpdated__c = FALSE
			LIMIT :contactLimit
		];
		if (contacts.isEmpty()) {
			throw new ProductboardException(
				'No master contact with clearbit found in Salesforce with System account for update.',
				ApiConstants.CODE_FAILED_RECORD_NOT_FOUND
			);
		}
		return contacts;
	}

	public static List<Contact> getContactsByPbUsers(List<Project_User__c> projectUsers) {
		List<Id> contactIds = new List<Id>();
		for (Project_User__c pu : projectUsers) {
			contactIds.add(pu.Contact__c);
		}
		List<Contact> contacts = [
			SELECT
				AccountId,
				Board_view_switched_space__c,
				Board_view_switched_user__c,
				Business_goal_column_value_set_space__c,
				Business_goal_column_value_set_user__c,
				cbit__ClearbitReady__c,
				cbit__Clearbit__c,
				cbit__CreatedByClearbit__c,
				cbit__Facebook__c,
				cbit__LinkedIn__c,
				cbit__Twitter__c,
				City__c,
				Column_filter_used_space__c,
				Column_filter_used_user__c,
				Complexity_column_value_set_space__c,
				Complexity_column_value_set_user__c,
				Contact_Source__c,
				Contact_Status__c,
				Contributors_invited_space__c,
				Contributors_invited_user__c,
				Country_Code__c,
				Country__c,
				CreatedById,
				CreatedDate,
				Department,
				Driver_created_space__c,
				Driver_created_user__c,
				Editors_invited_space__c,
				Editors_invited_user__c,
				Email,
				EmailBouncedDate,
				Feature_created_user__c,
				FirstName,
				Gender__c,
				Given_Name__c,
				HasOptedOutOfEmail,
				hasSubscription__c,
				Id,
				Indexed_At__c,
				Initiative_column_value_set_space__c,
				Initiative_column_value_set_user__c,
				isAdmin__c,
				isChurned__c,
				isContributor__c,
				IsDeleted,
				isEditor__c,
				IsEmailBounced,
				Paying_Customer_A__c,
				Paying_Customer_A_Last_Update__c,
				isTrial__c,
				isViewer__c,
				Jigsaw,
				JigsawContactId,
				Jira_import_issues_imported_space__c,
				Jira_import_issues_imported_user__c,
				LastActivityDate,
				LastCURequestDate,
				LastCUUpdateDate,
				Roadmap_shown_space__c,
				Roadmap_shown_user__c,
				Roadmap_view_switched_space__c,
				Roadmap_view_switched_user__c,
				Roadmap_visibility_toggled_space__c,
				Roadmap_visibility_toggled_user__c,
				Role__c,
				Salutation,
				Seniority__c,
				Signed_in_space__c,
				Signed_in_user__c,
				Site__c,
				Snippet_created_space__c,
				Snippet_created_user__c,
				State_Code__c,
				State__c,
				Suffix,
				SystemModstamp,
				Time_Zone__c,
				Title,
				Trial_End_Date__c,
				Trial_Request_DT__c,
				Trial_Source__c,
				Trial_Usage_Score__c,
				User_PB_ID__c,
				UTC_Offset__c,
				Viewers_invited_space__c,
				Viewers_invited_user__c,
				View_customized_space__c,
				View_customized_user__c,
				Productboard_Opt_in__c,
				SystemAccScriptUpdated__c
			FROM Contact
			WHERE Id IN :contactIds
		];
		if (contacts.isEmpty()) {
			throw new ProductboardException(
				'No master contact with clearbit found in Salesforce with System account for update.',
				ApiConstants.CODE_FAILED_RECORD_NOT_FOUND
			);
		}
		return contacts;
	}

	public static void insertContact(Contact con) {
		try {
			insert con;
		} catch (DmlException e) {
			throw new ProductboardException('Insert Contact was ended with errors: ' + e.getMessage(), ApiConstants.CODE_FAILED_DML_ERROR);
		}
	}

	public static void updateContact(Contact con) {
		try {
			update con;
		} catch (DmlException e) {
			throw new ProductboardException('Update Contact was ended with errors: ' + e.getMessage(), ApiConstants.CODE_FAILED_DML_ERROR);
		}
	}
}